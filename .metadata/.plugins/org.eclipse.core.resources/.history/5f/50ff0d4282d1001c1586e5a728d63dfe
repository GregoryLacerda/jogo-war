package com.gregory.jogowarapi.services;

import java.util.Arrays;
import java.util.HashSet;
import java.util.Set;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import com.gregory.jogowarapi.domain.Jogador;
import com.gregory.jogowarapi.domain.Pais;
import com.gregory.jogowarapi.repositories.JogadorRepository;
import com.gregory.jogowarapi.repositories.PaisRepository;

@Service
public class DBService {

	@Autowired
	private JogadorRepository jogadorRepository;
	
	@Autowired
	private PaisRepository paisRepository;
	
	public void instanciarDados() {
		
		Pais brasil = new Pais(null, "Brasil", 0, null);
		Pais chile = new Pais(null, "Chile", 0, null);
		Pais argentina = new Pais(null, "Argentina", 0, null);
		Pais uruguai = new Pais(null, "Uruguai", 0, null);
		
		brasil.addVizinhos(Arrays.asList(chile.getId(), argentina.getId(), uruguai.getId()));
		argentina.addVizinhos(Arrays.asList(brasil.getId(), chile.getId(), uruguai.getId()));
		chile.addVizinhos(Arrays.asList(brasil.getId(), argentina.getId(), uruguai.getId()));
		uruguai.addVizinhos(Arrays.asList(brasil.getId(), chile.getId(), argentina.getId()));
		
		paisRepository.saveAll(Arrays.asList(brasil, chile, argentina, uruguai));
		
		Jogador jogador1 = new Jogador(null, 10, "Jogador 1");
		Jogador jogador2 = new Jogador(null, 10, "Jogador 2");
		
		jogadorRepository.saveAll(Arrays.asList(jogador1, jogador2));
		
		jogador1.setPaises(new HashSet<>(Arrays.asList(brasil)));
		jogador2.setPaises(Set.copyOf(Arrays.asList(chile)));
		
		jogadorRepository.saveAll(Arrays.asList(jogador1, jogador2));
		
		brasil.setJogador(jogador1);
		chile.setJogador(jogador2);
		
		paisRepository.saveAll(Arrays.asList(brasil, chile));
	}

}
